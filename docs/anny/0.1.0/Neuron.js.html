<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Neuron.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Layer.html">Layer</a><ul class='methods'><li data-type='method'><a href="Layer.html#activate">activate</a></li><li data-type='method'><a href="Layer.html#connect">connect</a></li><li data-type='method'><a href="Layer.html#train">train</a></li></ul></li><li><a href="Network.html">Network</a><ul class='methods'><li data-type='method'><a href="Network.html#activate">activate</a></li><li data-type='method'><a href="Network.html#correct">correct</a></li><li data-type='method'><a href="Network.html#train">train</a></li></ul></li><li><a href="Neuron.html">Neuron</a><ul class='methods'><li data-type='method'><a href="Neuron.html#activate">activate</a></li><li data-type='method'><a href="Neuron.html#connect">connect</a></li><li data-type='method'><a href="Neuron.html#isInput">isInput</a></li><li data-type='method'><a href="Neuron.html#isOutput">isOutput</a></li><li data-type='method'><a href="Neuron.html#train">train</a></li></ul></li><li><a href="Neuron.Connection.html">Connection</a></li></ul><h3>Namespaces</h3><ul><li><a href="ACTIVATION.html">ACTIVATION</a><ul class='methods'><li data-type='method'><a href="ACTIVATION.html#.identity">identity</a></li><li data-type='method'><a href="ACTIVATION.html#.identityDerivative">identityDerivative</a></li><li data-type='method'><a href="ACTIVATION.html#.logistic">logistic</a></li><li data-type='method'><a href="ACTIVATION.html#.logisticDerivative">logisticDerivative</a></li><li data-type='method'><a href="ACTIVATION.html#.optimalTanh">optimalTanh</a></li><li data-type='method'><a href="ACTIVATION.html#.optimalTanhDerivative">optimalTanhDerivative</a></li><li data-type='method'><a href="ACTIVATION.html#.rectifier">rectifier</a></li><li data-type='method'><a href="ACTIVATION.html#.rectifierDerivative">rectifierDerivative</a></li><li data-type='method'><a href="ACTIVATION.html#.softplus">softplus</a></li><li data-type='method'><a href="ACTIVATION.html#.softplusDerivative">softplusDerivative</a></li><li data-type='method'><a href="ACTIVATION.html#.tanh">tanh</a></li><li data-type='method'><a href="ACTIVATION.html#.tanhDerivative">tanhDerivative</a></li></ul></li><li><a href="ERROR.html">ERROR</a><ul class='methods'><li data-type='method'><a href="ERROR.html#.arcTan">arcTan</a></li><li data-type='method'><a href="ERROR.html#.crossEntropy">crossEntropy</a></li><li data-type='method'><a href="ERROR.html#.meanSquared">meanSquared</a></li><li data-type='method'><a href="ERROR.html#.rootMeanSquared">rootMeanSquared</a></li></ul></li><li><a href="INITIALIZE.html">INITIALIZE</a><ul class='methods'><li data-type='method'><a href="INITIALIZE.html#.bias">bias</a></li><li data-type='method'><a href="INITIALIZE.html#.learningRate">learningRate</a></li><li data-type='method'><a href="INITIALIZE.html#.weight">weight</a></li></ul></li><li><a href="util.html">util</a><ul class='methods'><li data-type='method'><a href="util.html#.findFastestActivation">findFastestActivation</a></li><li data-type='method'><a href="util.html#.getApproximateDerivative">getApproximateDerivative</a></li><li data-type='method'><a href="util.html#.normalize">normalize</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">Neuron.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var INITIALIZE = require('./Initialize');
var ACTIVATION = require('./Activation');

/**
 * A Neuron is the smallest unit of an artificial neural network.  They are not
 * useful until connected.
 * @constructor
 */
function Neuron() {
  /**
   * Flag identifying this Neuron as a Bias Neuron.  Bias Neurons are like all
   * all ot
   * @type {boolean}
   */
  this.isBias = false;

  /**
   * A unique id beginning at 0 and are incremented for every Neuron created.
   * @type {number}
   */
  this.id = Neuron.count++;

  /**
   * An array of Neuron.Connection
   * @type {Array}
   */
  this.incoming = [];
  this.outgoing = [];

  // signal values
  this.input = 0;
  this.output = 0;

  // activation
  this.activationFn = ACTIVATION.tanh;
  this.activationDerivative = ACTIVATION.tanhDerivative;

  // learning
  this.error = 0;
  this.delta = 0;
  this.learningRate = INITIALIZE.learningRate();
}

/**
 * A running total number of Neurons created.  It is only used to generate
 * unique ids for each Neuron. Creating a new Neuron increments the count but
 * it is never decremented.
 * @type {number}
 */
Neuron.count = 0;

/**
 * The connection between two Neurons.  Connections are unidirectional.
 * @param {object} source - Neuron that will send its output to the `target`
 *   Neuron.
 * @param {object} target - Neuron that will get its input from the `source`
 *   Neuron.
 * @param {number} weight - The strength of the connection.  Meaning, how much
 *   of the `source` output is passed to the `target` Neuron input.
 * @constructor
 */
Neuron.Connection = function(source, target, weight) {
  /**
   * A reference to the actual Neuron that is at the beginning of this
   * Connection.
   * @type {Neuron}
   */
  this.source = source;

  /**
   * A reference to the actual Neuron that is at the end of this Connection.
   * @type {Neuron}
   */
  this.target = target;

  // We add one to initialize the weight value as if this connection were
  // already part of the fan.
  /**
   * The weight is used as a multiplier for two purposes.  First, for
   * activation, when transferring the output of the `source` Neuron to the
   * input of the `target` Neuron. Second, during training, calculating the
   * total error delta.
   * @type {number}
   */
  this.weight = weight || INITIALIZE.weight(target.incoming.length + 1);
};

/**
 * Train the Neuron to output the `targetOutput`.  If a `targetOutput` is not
 * provided, the Neuron will train itself to minimize the error of the Neurons
 * from its outgoing connections.
 * @param {number} [targetOutput] - Manually set the target output.error.
 */
Neuron.prototype.train = function(targetOutput) {
  var inputDerivative = this.activationDerivative(this.input);

  if (!_.isUndefined(targetOutput)) {
    this.error = targetOutput - this.output;
  }

  // set the delta
  // https://www.youtube.com/watch?v=p1-FiWjThs8
  //
  // Input Neurons and Bias Neurons do not need to calculate their delta.
  // This is because the delta is only used to update the weight but only the
  //   target Neuron's delta is used: targetDelta * weight * gradient.
  // Since input Neurons and Bias Neurons are strictly source Neurons
  //   they will never be a target Neuron and their delta's never used
  if (!this.isInput() &amp;&amp; !this.isBias) {
    if (this.isOutput()) {
      this.delta = -this.error * inputDerivative;
    } else {
      this.delta = _.sum(this.outgoing, function(connection) {
        return inputDerivative * connection.weight * connection.target.delta;
      });
    }
  }

  // adjust weights
  _.each(this.outgoing, function(connection) {
    // get gradient
    // https://youtu.be/p1-FiWjThs8?t=12m21s
    var gradient = this.output * connection.target.delta;

    connection.weight -= gradient * this.learningRate;
  }, this);
};

/**
 * Activate this Neuron, setting the input value and computing the output.
 *   Input Neuron output values will always be equal to their input value.
 *   Bias Neurons always output 1.
 *   All other Neurons will squash their input value to derive their output.
 * @param {number} [input] - If omitted the input value will be calculated
 *   from the outputs and weights of the Neurons connected to this Neuron.
 * @returns {number}
 */
Neuron.prototype.activate = function(input) {
  if (this.isBias) {
    this.output = 1;
    return this.output;
  }

  // set the input
  if (!_.isUndefined(input)) {
    this.input = input;
  } else {
    this.input = _.sum(this.incoming, function(connection) {
      // we don't need to add the bias neuron manually here.
      // since the bias Neuron is connected like all other Neurons and it's
      // output is always 1, the weight will be added by bias.output * weight.
      return connection.source.output * connection.weight;
    });
  }

  // set the output
  // do not squash input Neurons values, pass them straight through
  this.output = this.isInput() ? this.input : this.activationFn(this.input);

  return this.output;
};

/**
 * Connect this Neuron to another Neuron.
 * @param {Neuron} target - The Neuron to connect to.
 * @param {number} weight - The strength of the connection.
 */
Neuron.prototype.connect = function(target, weight) {
  // bias Neurons are not allowed to have inputs
  if (target.isBias) {
    return;
  }

  var connection = Neuron.connection(this, target, weight);
  this.outgoing.push(connection);
  target.incoming.push(connection);
};

/**
 * Determine if this Neuron is an input Neuron.
 * @returns {boolean}
 */
Neuron.prototype.isInput = function() {
  return !this.isBias &amp;&amp; this.incoming.length === 0;
};

/**
 * Determine if this Neuron is an output Neuron.
 * @returns {boolean}
 */
Neuron.prototype.isOutput = function() {
  return this.outgoing.length === 0;
};

module.exports = Neuron;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
