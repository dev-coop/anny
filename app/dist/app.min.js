function AnnyFactory(t){var n={};return n.init=function(){n.newNetwork([2,1])},n.activate=function(t){n.network.activate(t),n.emitChange()},n.getRandomLayers=function(){var t=2,n=1,e=_.random(1,3),o=[];return _.times(e,function(){o.push(_.random(3,5))}),[].concat(t,o,n)},n.train=function(t,e,o){n.network.train(t,e,o);var i=["Predictions after training:"];_.each(t,function(t){var e=t.input,o=n.network.activate(e);i.push("["+e.toString()+"] == "+(o>=.5)+" "+o)}),console.log(i.join("\n")),n.emitChange()},n.newNetwork=function(t){n.network=new anny.Network(t||n.getRandomLayers()),n.emitChange()},n.emitChange=function(){t.$broadcast("anny:changed"),window.network=n.network},n.init(),n}function visNetworkOptions(){var t={height:"100%",width:"100%"};return t.nodes={borderWidth:.1,borderWidthSelected:.1,shape:"dot",scaling:{min:5,max:15},font:{color:"#777",size:12,face:"Lato"},labelHighlightBold:!0,mass:1},t.groups={normal:{color:{border:"hsl(210, 20%, 25%)",background:"hsl(210, 80%, 80%)",hover:{border:"hsl(210, 35%, 45%)",background:"hsl(210, 80%, 80%)"},highlight:{border:"hsl(210, 60%, 70%)",background:"hsl(210, 80%, 80%)"}}},bias:{borderWidth:2,borderWidthSelected:2,color:{border:"hsl(0, 0%, 40%)",background:"transparent",hover:{border:"hsl(0, 0%, 60%)",background:"transparent"},highlight:{border:"hsl(0, 0%, 80%)",background:"transparent"}}}},t.edges={smooth:{enabled:!1,type:"dynamic",roundness:.5},scaling:{min:.5,max:8},hoverWidth:1,selectionWidth:1.5},t.layout={hierarchical:{direction:"LR"}},t.interaction={hover:!0,tooltipDelay:150},t.physics={enabled:!0,hierarchicalRepulsion:{centralGravity:0,springLength:50,springConstant:.002,nodeDistance:80,damping:.4},maxVelocity:50,minVelocity:.1,stabilization:{enabled:!0,iterations:0,updateInterval:0,onlyDynamicEdges:!1,fit:!0},timestep:.5},t}function visNetwork(t,n,e){return{replace:!0,scope:{},template:'<div class="vis-network-container"></div>',link:function(o,i){o.getData=function(){var t=[],e=[];return _.each(n.network.allLayers,function(n,o){_.each(n.neurons,function(n){var i=n.id,a=n.input.toFixed(3),r=n.output.toFixed(3),u=n.delta.toFixed(6),s=n.error.toFixed(3);t.push({id:i,title:["<b>id:</b> ",i,"<br/>","<b>delta:</b> ",u,"<br/>"].join(""),level:o,label:(n.isInput()?["\no:",r]:n.isOutput()?["\ni:",a,"\no:",r,"\ne:",s]:n.isBias?["\no:",r]:["\ni:",a,"\no:",r]).join(" "),value:Math.abs(r),group:n.isBias?"bias":"normal"}),_.each(n.outgoing,function(t){var n=t.weight.toFixed(3);e.push({from:t.source.id,to:t.target.id,value:Math.abs(n),title:"weight: "+n,color:{color:n>=0?"hsl(210, 20%, 25%)":"hsl(30, 15%, 25%)",hover:n>=0?"hsl(210, 35%, 45%)":"hsl(30, 40%, 40%)",highlight:n>=0?"hsl(210, 60%, 70%)":"hsl(30, 60%, 60%)"}})})})}),{nodes:new vis.DataSet(t),edges:new vis.DataSet(e)}},o.setData=function(){o.network.setData(o.getData())},e.$on("anny:changed",function(){o.setData()}),o.network=new vis.Network(i[0],o.getData(),t)}}}angular.module("App",["anny","App.vis","App.toolbar","App.graph"]),angular.module("anny",[]),angular.module("App.graph",[]),angular.module("App.toolbar",[]),angular.module("App.vis",[]),AnnyFactory.$inject=["$rootScope"],angular.module("anny").factory("AnnyFactory",AnnyFactory),angular.module("App.vis").factory("visNetworkOptions",visNetworkOptions),angular.module("App.graph").directive("graph",function(){return{replace:!0,scope:{},template:'<div class="vis-graph-container"></div>',link:function(t,n){function e(){a.add({x:Date.now(),y:l,group:0}),l-=l/5,s.redraw(),setTimeout(e,1e3)}function o(){var t=1e4;s.setWindow(c,Date.now()+t),setTimeout(function(){o()},t)}var i=n[0],a=new vis.DataSet,r=new vis.DataSet;r.add({id:0,content:"error",className:"vis-error-graph-style",options:{drawPoints:{size:0,style:"circle"},shaded:{orientation:"bottom"}}});var u={moveable:!1,width:"100%",height:"100%",start:vis.moment(),legend:{left:{visible:!0,position:"top-left"}},dataAxis:{visible:!0,showMajorLabels:!0,showMinorLabels:!0,width:"0px",left:{range:{min:0}},right:{range:{min:0}}}},s=new vis.Graph2d(i,a,r,u),l=1,c=Date.now();!function(){e(),o()}()}}}),angular.module("App.toolbar").directive("toolbar",["AnnyFactory",function(t){return{replace:!0,scope:{},templateUrl:"app/dist/components/toolbar/toolbar.html",link:function(n){n.resetNet=function(){t.init()},n.randomNet=function(){t.newNetwork()},n.activateRandom=function(){var n=[];_.times(t.network.inputLayer.neurons.length,function(){n.push(_.random(-1,1,!0))}),t.activate(n)},n.trainORGate=function(){t.train([{input:[0,0],output:[0]},{input:[0,1],output:[1]},{input:[1,0],output:[1]},{input:[1,1],output:[1]}])},n.trainXORGate=function(){t.train([{input:[0,0],output:[0]},{input:[0,1],output:[1]},{input:[1,0],output:[1]},{input:[1,1],output:[0]}])},n.trainANDGate=function(){t.train([{input:[0,0],output:[0]},{input:[0,1],output:[0]},{input:[1,0],output:[0]},{input:[1,1],output:[1]}])},n.trainNANDGate=function(){t.train([{input:[0,0],output:[1]},{input:[0,1],output:[1]},{input:[1,0],output:[1]},{input:[1,1],output:[0]}])}}}}]),visNetwork.$inject=["visNetworkOptions","AnnyFactory","$rootScope"],angular.module("App.vis").directive("visNetwork",visNetwork);