function AnnyFactory(t){var n=new anny.Network([2,2,1]);_.times(100,function(t){console.log("asdf");n.train([{input:[1,2],output:[-3]}])});var o=n.activate([1,2]);console.log(o);var e={};return e.init=function(){e.network=window.network=n},e.activate=function(t){e.network.activate(t),e.emitChange()},e.getRandomLayers=function(){var t=1,n=1,o=_.random(0,2),e=[];return _.times(o,function(){e.push(_.random(2,4))}),[].concat(t,e,n)},e.train=function(t,n){e.network.train(t,n,function(t,n){console.log("Network training",t,"error",n)}),e.emitChange()},e.newNetwork=function(t){e.network=new anny.Network(t||e.getRandomLayers()),e.emitChange()},e.emitChange=function(){t.$broadcast("anny:changed")},e.init(),e}function visNetworkOptions(){var t={};return t.nodes={borderWidth:.1,borderWidthSelected:.1,shape:"dot",scaling:{min:5,max:15},font:{color:"#777",size:12,face:"Lato"},labelHighlightBold:!0,mass:1},t.groups={normal:{color:{border:"hsl(210, 20%, 25%)",background:"hsl(210, 80%, 80%)",hover:{border:"hsl(210, 35%, 45%)",background:"hsl(210, 80%, 80%)"},highlight:{border:"hsl(210, 60%, 70%)",background:"hsl(210, 80%, 80%)"}}},gate:{color:{border:"hsl(30, 15%, 25%)",background:"hsl(30, 100%, 70%)",hover:{border:"hsl(30, 40%, 40%)",background:"hsl(30, 100%, 70%)"},highlight:{border:"hsl(30, 60%, 60%)",background:"hsl(30, 100%, 70%)"}}}},t.edges={smooth:{enabled:!1,type:"dynamic",roundness:.5},scaling:{min:.2,max:4},hoverWidth:1,selectionWidth:1.5},t.layout={hierarchical:{direction:"LR"}},t.interaction={hover:!0,tooltipDelay:150},t.physics={enabled:!0,hierarchicalRepulsion:{centralGravity:0,springLength:50,springConstant:.002,nodeDistance:80,damping:.4},maxVelocity:50,minVelocity:.1,stabilization:{enabled:!0,iterations:0,updateInterval:0,onlyDynamicEdges:!1,fit:!0},timestep:.5},t}function visNetwork(t,n,o){return{replace:!0,scope:{},template:'<div class="vis-network"></div>',link:function(e,a){e.getData=function(){var t=[],o=[];return _.each(n.network.allLayers,function(n,e){_.each(n.neurons,function(n){var a=n.id,r=n.oldInput.toFixed(3),i=n.output.toFixed(3),l=n.error.toFixed(3);t.push({id:a,title:["<b>id:</b> ",a,"<br/>","<b>in:</b> ",r,"<br/>","<b>out:</b> ",i,"<br/>","<b>err:</b> ",l,"<br/>","<b>bias:</b> ",n.isBiasNeuron,"<br/>"].join(""),level:e,label:["\n","\ni:",r,"\no:",i,"\ne:",l].join(" "),value:Math.abs(i),group:"normal"}),_.each(n.outgoing,function(t){var n=t.weight.toFixed(3);o.push({from:t.source.id,to:t.target.id,value:Math.abs(n),title:"weight: "+n,color:{color:n>=0?"hsl(210, 20%, 25%)":"hsl(30, 15%, 25%)",hover:n>=0?"hsl(210, 35%, 45%)":"hsl(30, 40%, 40%)",highlight:n>=0?"hsl(210, 60%, 70%)":"hsl(30, 60%, 60%)"}})})})}),{nodes:new vis.DataSet(t),edges:new vis.DataSet(o)}},e.setData=function(){e.network.setData(e.getData())},o.$on("anny:changed",function(){e.setData()}),e.network=new vis.Network(a[0],e.getData(),t)}}}angular.module("App",["anny","App.vis","App.toolbar"]);var targetOutput=1,cycles=100,a=new anny.Neuron,b=new anny.Neuron;a.connect(b),a.learningRate=b.learningRate=.1,console.log("app.js: Learning to output",targetOutput),_.times(cycles,function(t){var n=a.activate(1).toFixed(6),o=b.activate().toFixed(6);b.error=(targetOutput-b.output).toFixed(6),t%(cycles/10)===0&&console.log("["+t+"] a("+n+") <-("+a.outgoing[0].weight.toFixed(6)+")-> b("+o+") = e "+b.error),a.correct()}),angular.module("anny",[]),angular.module("App.toolbar",[]),angular.module("App.vis",[]),AnnyFactory.$inject=["$rootScope"],angular.module("anny").factory("AnnyFactory",AnnyFactory),angular.module("App.vis").factory("visNetworkOptions",visNetworkOptions),angular.module("App.toolbar").directive("toolbar",["AnnyFactory",function(t){return{replace:!0,scope:{},templateUrl:"app/dist/components/toolbar/toolbar.html",link:function(n){n.randomNet=function(){t.newNetwork()},n.activateRandom=function(){var n=[];_.times(t.network.inputLayer.neurons.length,function(){n.push(_.random(!0))}),t.activate(n)},n.train=function(){var n=1e3,o=_.floor(n/10),e=_.times(n,function(){var t=_.random(-1,1,!0);return{input:[t],output:[t+1]}});t.train(e,o)}}}}]),visNetwork.$inject=["visNetworkOptions","AnnyFactory","$rootScope"],angular.module("App.vis").directive("visNetwork",visNetwork);